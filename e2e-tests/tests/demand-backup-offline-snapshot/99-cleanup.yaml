apiVersion: kuttl.dev/v1beta1
kind: TestStep
delete:
- apiVersion: pgv2.percona.com/v2
  kind: PerconaPGCluster
  metadata:
    name: backup-snapshot
- apiVersion: postgres-operator.crunchydata.com/v1beta1
  kind: PostgresCluster
  metadata:
    name: backup-snapshot
- apiVersion: pgv2.percona.com/v2
  kind: PerconaPGBackup
  metadata:
    name: backup1
- apiVersion: pgv2.percona.com/v2
  kind: PerconaPGBackup
  metadata:
    name: backup2
- apiVersion: snapshot.storage.k8s.io/v1
  kind: VolumeSnapshot
  metadata:
    name: backup1-pgdata
- apiVersion: snapshot.storage.k8s.io/v1
  kind: VolumeSnapshot
  metadata:
    name: backup3-pgdata
commands:
  - script: |-
      set -o errexit
      set -o xtrace

      source ../../functions

      remove_all_finalizers
      destroy_operator
    timeout: 60
